<!--
  This is a program that emulates a small subset of the `sed` unix
  command. It replaces a regex in the incoming text with a string
-->

<script>
  window.onmessage = e => {
    const params = new URLSearchParams(window.location.search);
    const regex = new RegExp(params.get("regex"));
    const replace = params.get("replace");
    window.parent.postMessage(
      ["print", e.data.join("\n").replace(regex, replace)],
      "*"
    );
    window.parent.postMessage(["exit", 0], "*");
  };
</script>
